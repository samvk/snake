"use strict";$(document).ready(function(){function u(){$("#snake-container").empty(),$('<div class="snake head">').appendTo("#snake-container");var e=o.headTop()-t,n=o.headTop()-2*t;$('<div class="snake belly">').appendTo("#snake-container").css({top:e,left:o.headLeft}),$('<div class="snake belly">').appendTo("#snake-container").css({top:n,left:o.headLeft}),a=[],a.push([e,o.headLeft()]),a.push([n,o.headLeft()]),r.newHeadPos=function(){r.headDirection="down";var e=$(".head");e.css({top:"+="+t})}}function f(){c(),r.init(),l.init(),d.init()}function p(){e=!1,$("#play-again__screen").fadeOut(150),$("#arrow__screen").fadeIn(150),i=0,$(".highscore").text(i),$(".bestscore").text(s),u(),function t(){f(),e||setTimeout(t,100)}()}var e=!1,t=parseInt($(".snake").css("width")),n=parseInt($("#game-box").css("width")),a=[],i=0,s=function(){for(var e="bestscore=",t=document.cookie.split(";"),n=0;n<t.length;n++){for(var a=t[n];" "===a.charAt(0);)a=a.substring(1);if(0===a.indexOf(e))return a.substring(e.length,a.length)}return 0}(),o={headTop:function(){return parseInt($(".head").css("top"))},headLeft:function(){return parseInt($(".head").css("left"))},appleTop:function(){return parseInt($(".apple").css("top"))},appleLeft:function(){return parseInt($(".apple").css("left"))},tailTop:function(){return parseInt($(".snake").last().css("top"))},tailLeft:function(){return parseInt($(".snake").last().css("left"))}},c=function(){var e=$($(".belly").get().reverse());e.each(function(e,t){var n=$(t),a=n.prev();n.css({top:a.css("top"),left:a.css("left")});var i=a.data("direction");n.data("direction",i)})},r=function(){function e(){a.push([o.headTop(),o.headLeft()]),a.shift()}return{headDirection:"down",newHeadPos:function(){this.headDirection="down";var e=$(".head");e.css({top:"+="+t})},setDirection:function(e){var n=$(".head");switch(e=parseInt(e.which,10)||e){case"up":case 87:case 38:case 104:this.newHeadPos=function(){this.headDirection="up",n.css({top:"-="+t})};break;case"down":case 83:case 40:case 98:case 101:this.newHeadPos=function(){this.headDirection="down",n.css({top:"+="+t})};break;case"left":case 65:case 37:case 100:this.newHeadPos=function(){this.headDirection="left",n.css({left:"-="+t})};break;case"right":case 68:case 39:case 102:this.newHeadPos=function(){this.headDirection="right",n.css({left:"+="+t})}}},init:function(){e(),this.newHeadPos(),$(".head").data("direction",this.headDirection)}}}();$(document).keydown(function(e){r.setDirection(e)}),$(".arrow").click(function(){var e=$(this).data("direction");r.setDirection(e)});var l=function(){function e(){a.unshift([o.tailTop(),o.tailLeft()])}function s(){var n=$(".snake").last();n.after('<div class="snake belly"></div>');var a=$(".snake").last(),i=n.data("direction"),s=parseInt(n.css("top")),o=parseInt(n.css("left"));switch(i){case"up":a.css({top:s+t,left:o});break;case"down":a.css({top:s-t,left:o});break;case"left":a.css({top:s,left:o+t});break;case"right":a.css({top:s,left:o-t})}e()}function c(){function e(){return 10*Math.round(Math.floor(Math.random()*(n-t))/10)}var i=e(),s=e();$(".apple").css({top:i,left:s});for(var o=[i,s],r=0;r<a.length;r++)if(o.join()===a[r].join())return void c()}return{init:function(){o.headTop()===o.appleTop()&&o.headLeft()===o.appleLeft()&&(c(),s(),i+=10,$(".highscore").text(i))}}}(),d=function(){function c(e,t){var n=new Date;n.setTime(n.getTime()+31536e6);var a="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+a}function r(t){i>s&&(s=i,c("bestscore",i)),$(".play-again__message").text(t),$("#play-again__screen").fadeIn(150),$("#arrow__screen").fadeOut(150),$(".play-again__button").focus(),e=!0}function l(){(o.headTop()<0||o.headLeft()<0||o.headTop()>n-t||o.headLeft()>n-t)&&r("Out of bounds!")}function d(){for(var e=[o.headTop(),o.headLeft()],t=0;t<a.length;t++)if(e.join()===a[t].join())return void r("Stop hitting yourself!")}return{init:function(){l(),d()}}}();p(),$(".play-again__button").click(function(){e&&p()})});