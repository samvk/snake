"use strict";$(document).ready(function(){function h(){$("#snake-container").empty(),$('<div class="snake head">').appendTo("#snake-container");var e=o.headTop()-t,a=o.headTop()-2*t;$('<div class="snake belly">').appendTo("#snake-container").css({top:e,left:o.headLeft}),$('<div class="snake belly">').appendTo("#snake-container").css({top:a,left:o.headLeft}),n=[],n.push([e,o.headLeft()]),n.push([a,o.headLeft()]),c.newHeadPos=function(){c.headDirection="down";var e=$(".head");e.css({top:"+="+t})}}function u(){r(),c.init(),f.init(),d.init()}function p(){e=!1,$("#play-again__screen").fadeOut(150),$("#arrow__screen").fadeIn(150),i=0,$(".highscore").text(i),$(".bestscore").text(s),h(),function t(){u(),e||setTimeout(t,100)}()}var e=!1,t=parseInt($(".snake").css("width")),a=parseInt($("#game-box").css("width")),n=[],i=0,s=function(){for(var e="bestscore=",t=document.cookie.split(";"),a=0;a<t.length;a++){for(var n=t[a];" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(e))return n.substring(e.length,n.length)}return 0}(),o=function(){function e(e,t){return function(){return parseInt($("."+e).last().css(t))}}return{headTop:e("head","top"),headLeft:e("head","left"),appleTop:e("apple","top"),appleLeft:e("apple","left"),tailTop:e("snake","top"),tailLeft:e("snake","left")}}(),r=function(){var e=$($(".belly").get().reverse());e.each(function(e,t){var a=$(t),n=a.prev();a.css({top:n.css("top"),left:n.css("left")});var i=n.data("direction");a.data("direction",i)})},c=function(){function e(){n.push([o.headTop(),o.headLeft()]),n.shift()}return{headDirection:"down",newHeadPos:function(){this.headDirection="down";var e=$(".head");e.css({top:"+="+t})},setDirection:function(e){var a=$(".head");switch(e=parseInt(e.which,10)||e){case"up":case 87:case 38:this.newHeadPos=function(){this.headDirection="up",a.css({top:"-="+t})};break;case"down":case 83:case 40:this.newHeadPos=function(){this.headDirection="down",a.css({top:"+="+t})};break;case"left":case 65:case 37:this.newHeadPos=function(){this.headDirection="left",a.css({left:"-="+t})};break;case"right":case 68:case 39:this.newHeadPos=function(){this.headDirection="right",a.css({left:"+="+t})}}},init:function(){e(),this.newHeadPos(),$(".head").data("direction",this.headDirection)}}}();$(document).keydown(function(e){c.setDirection(e)}),$(".arrow").click(function(){var e=$(this).data("direction");c.setDirection(e)});var f=function(){function e(){n.unshift([o.tailTop(),o.tailLeft()])}function s(){var a=$(".snake").last();a.after('<div class="snake belly"></div>');var n=$(".snake").last(),i=a.data("direction"),s=parseInt(a.css("top")),o=parseInt(a.css("left"));switch(i){case"up":n.css({top:s+t,left:o});break;case"down":n.css({top:s-t,left:o});break;case"left":n.css({top:s,left:o+t});break;case"right":n.css({top:s,left:o-t})}e()}function r(){function e(){return 10*Math.round(Math.floor(Math.random()*(a-t))/10)}var i=e(),s=e();$(".apple").css({top:i,left:s});for(var o=[i,s],c=0;c<n.length;c++)if(o.join()===n[c].join())return void r()}return{init:function(){o.headTop()===o.appleTop()&&o.headLeft()===o.appleLeft()&&(r(),s(),i+=10,$(".highscore").text(i))}}}(),d=function(){function r(e,t){var a=new Date;a.setTime(a.getTime()+31536e6);var n="expires="+a.toUTCString();document.cookie=e+"="+t+"; "+n}function c(t){i>s&&(s=i,r("bestscore",i)),$(".play-again__message").text(t),$("#play-again__screen").fadeIn(150),$("#arrow__screen").fadeOut(150),$(".play-again__button").focus(),e=!0}function f(){(o.headTop()<0||o.headLeft()<0||o.headTop()>a-t||o.headLeft()>a-t)&&c("Out of bounds!")}function d(){for(var e=[o.headTop(),o.headLeft()],t=0;t<n.length;t++)if(e.join()===n[t].join())return void c("Stop hitting yourself!")}return{init:function(){f(),d()}}}();p(),$(".play-again__button").click(function(){e&&p()})});